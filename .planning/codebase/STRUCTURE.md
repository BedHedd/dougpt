# Codebase Structure

**Analysis Date:** 2026-02-21

## Directory Layout

```
[project-root]/
├── 00-dev-log/                 # Developer logs and templates
├── 00-supporting-files/        # Shared media assets (frames, images, caches)
├── 01-dev-onboarding/          # Onboarding resources (empty scaffold)
├── 02-worktrees/               # Branch-specific worktrees and experiments
│   ├── 00-experiments/         # uv-based sandbox (template)
│   ├── chat-extraction/        # Active marimo/vision extraction experiments
│   └── old-master/             # Snapshot of earlier branch (mostly empty code)
├── .planning/                  # GSD planning artifacts
└── README.md                   # Repo overview
```

## Directory Purposes

**00-dev-log/**
- Purpose: Chronological developer journals and templates.
- Contains: Markdown logs (`00-dev-log/*.md`).
- Key files: `00-dev-log/2026-02-09.md` (latest log), `00-dev-log/00-template.md`.

**00-supporting-files/**
- Purpose: Media inputs and cached outputs used by experiments.
- Contains: Keyframe caches (`data/*keyframe_cache/`), cropped chat frames (`data/chat_frames_test_30s_color/`), extracted outputs (`data/extractions/`), dated screenshots (`images/YYYY-MM-DD/`).
- Key files: Image assets consumed by marimo app in `02-worktrees/chat-extraction/chat-extraction.py`.

**01-dev-onboarding/**
- Purpose: Placeholder for onboarding materials; currently empty.
- Contains: No tracked files.

**02-worktrees/**
- Purpose: House separate working directories per branch/experiment.
- Contains: Worktree-specific `pyproject.toml`, notebooks, optional `.venv/`.
- Key dirs: `02-worktrees/chat-extraction/` (primary active code), `02-worktrees/00-experiments/` (template), `02-worktrees/old-master/` (legacy snapshot).

**.planning/**
- Purpose: GSD planning state and generated documentation.
- Contains: Roadmap/state files and codebase maps (`.planning/codebase/*.md`).

## Key File Locations

**Entry Points:**
- `02-worktrees/chat-extraction/chat-extraction.py`: marimo app driving chat extraction experiments.
- `02-worktrees/chat-extraction/chat-extraction-script.ipynb`: Jupyter exploration companion.

**Configuration:**
- `02-worktrees/chat-extraction/pyproject.toml`: Python dependencies for chat-extraction worktree.
- `02-worktrees/00-experiments/pyproject.toml`: Template dependency set for experiments.

**Core Logic:**
- `02-worktrees/chat-extraction/chat-extraction.py`: Path discovery, ffmpeg/OpenCV probes, OpenAI vision prompts, response display.

**Testing:**
- Not detected; no `tests/` or `*.test.*` files present.

## Naming Conventions

**Files:**
- Experiments and scripts use kebab-style names with context (`chat-extraction.py`, `sandbox.ipynb`).
- Data/cache folders include task descriptors (`cropped_kf_cache_test`, `chat_frames_test_30s_color`).

**Directories:**
- Numeric prefixes enforce ordering (`00-`, `01-`, `02-`).
- Worktrees named after branch focus (`chat-extraction`, `old-master`).

## Where to Add New Code

**New Feature:**
- Primary code: Create under a dedicated worktree in `02-worktrees/<branch>/`; include scripts/notebooks alongside a local `pyproject.toml`.
- Tests: Co-locate with scripts in the same worktree (none currently present).

**New Component/Module:**
- Implementation: Add new marimo apps or Python modules inside `02-worktrees/<branch>/` to keep branch scopes isolated.

**Utilities:**
- Shared helpers: Place reusable scripts/modules within the active worktree directory; reference shared assets from `00-supporting-files/`.

## Special Directories

**02-worktrees/chat-extraction/.venv/**
- Purpose: Local virtual environment for the worktree.
- Generated: Yes (tooling-generated by uv/venv).
- Committed: No (should remain untracked aside from metadata files).

**00-supporting-files/data/**
- Purpose: Large media assets and caches consumed by experiments.
- Generated: Partially (output caches), partially curated inputs.
- Committed: Yes (present in repository); treat as read-mostly inputs for scripts.

---

*Structure analysis: 2026-02-21*
